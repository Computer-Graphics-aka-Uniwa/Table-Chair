<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<script src="Libraries/webgl-debug.js"></script> 
		<script src="Libraries/gl-matrix-min.js"></script>

		<script id="vShader" type="x-shader/x-vertex">
			attribute vec4 aVertexPosition;
			varying vec4 vColor;
			void main() {
				gl_Position = aVertexPosition;
				vColor = vec4(0.0, 0.0, 1.0, 1.0);
			}
		</script>
		
		<script id="fshader" type="x-shader/x-fragment">
			precision mediump float;
			varying vec4 vColor;
			void main() {
				gl_FragColor = vColor;
			}
		</script>

		<script>
			var gl;
			var canvas;
			var shadersProgram;
			var vertexPositionAttributePointer;
			var vertexBuffer;

			function createWebGlContext(inCanvas) {
				var webGlContext = null;
				webGlContext = inCanvas.getContext("webgl");
				if (!webGlContext) {
					webGlContext = inCanvas.getContext("experimental-webgl");
				}
				if (!webGlContext) {
					alert("WebGL not supported!");
				}

				return webGlContext;
			}

			function createCompileShader(shaderType, shaderSource) {
				var outShader = gl.createShader(shaderType);
				gl.shaderSource(outShader, shaderSource);
				gl.compileShader(outShader);
				if (!gl.getShaderParameter(outShader, gl.COMPILE_STATUS)) {
					alert("Error compiling shader: " + gl.getShaderInfoLog(outShader));
					gl.deleteShader(outShader);
					return null;
				}
				
				return outShader;
			}

			function initShaders() {
				var vertexShaderSource = document.getElementById("vShader").text;
				var fragmentShaderSource = document.getElementById("fshader").text;
				var vertexShader = createCompileShader(gl.VERTEX_SHADER, vertexShaderSource);
				var fragmentShader = createCompileShader(gl.FRAGMENT_SHADER, fragmentShaderSource);
				shadersProgram = gl.createProgram();
				gl.attachShader(shadersProgram, vertexShader);
				gl.attachShader(shadersProgram, fragmentShader);
				gl.linkProgram(shadersProgram);
				if (!gl.getProgramParameter(shadersProgram, gl.LINK_STATUS)) {
					alert("Error linking shaders program: " + gl.getProgramInfoLog(shadersProgram));
				}
				gl.useProgram(shadersProgram);
				vertexPositionAttributePointer = gl.getAttribLocation(shadersProgram, "aVertexPosition");
				gl.enableVertexAttribArray(vertexPositionAttributePointer);
			}

			function initBuffers() {
				var triangleVertices = new Float32Array([
					0.5, 0.5, 0.5, 1.0,
					0.5, -0.5, 0.5, 1.0,
					-0.5, -0.5, 0.5, 1.0
				]);
				vertexBuffer = gl.createBuffer();
				gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
				gl.bufferData(gl.ARRAY_BUFFER, triangleVertices, gl.STATIC_DRAW);
				vertexBuffer.itemSize = 4;
				vertexBuffer.itemCount = 3;
			}

			function drawScene() {
				gl.viewport(0, 0, canvas.width, gl.drawingBufferHeight);
				gl.clear(gl.COLOR_BUFFER_BIT);
				gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
				gl.vertexAttribPointer(vertexPositionAttributePointer, vertexBuffer.itemSize, gl.FLOAT, false, 0, 0);
				gl.drawArrays(gl.TRIANGLEs, 0, vertexBuffer.itemCount);
			}

			function main() {
				var minDimension = Math.min(window.innerHeight, window.innerWidth);
				canvas = document.getElementById("canvas");
				canvas.width = 0.95 * minDimension;
				canvas.height = 0.95 * minDimension;
				gl = createWebGlContext(canvas);
				initShaders();
				initBuffers();
				gl.clearColor(0.5, 0.5, 0.5, 1.0);
				drawScene();
			} 
		</script>

	</head>

	<body onload="main()">
		<canvas id="canvas">

		</canvas>
	</body>
</html>